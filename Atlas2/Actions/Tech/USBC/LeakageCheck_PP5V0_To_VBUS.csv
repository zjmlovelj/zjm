Function,Inputs,Outputs,Retry,RetryHandler,OnError,SubSubTest,Conditions,ReturnOnFail,Notes
Parameters,,slotNum,,,,,,,
,,production_mode,,,,,,,
Tech/Fixture>sendFixtureCommand,"{subsubtestname=""Set-PDVBUS-0V""}",,,,,,,,"Set PDVBUS to 5v"
,"+{Commands=""relay_switch""}",,,,,,,,
,"+{args=""pdvbus;off""}",,,,,,,,
,"+{slotNum=slotNum}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Common>delay,"{subsubtestname=""Delay-1000ms_1""}",,,,,,,,"Delay 1000ms"
,"+{delay=""1000""}",,,,,,,,
,"+{unit=""ms""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-ACE_Enter_S0_CMD""}",,,,,,,,"ACE Enter S0 Status,rdar://112808243"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace --pick ATC0 --4cc SSPS --txdata ""0x00"" --rxdata 0;wait 500;ace --pick ATC0 --4cc SRDY --txdata ""0x00"" --rxdata 0""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-TypeC_And_CC_Disable_CMD""}",,,,,,,,"To disable TypeC and CC pull down"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace -p ATC0 -c LDCM -t ""0x08 0x31 0x33 0x44 0x56 0x00 0x10 0x12 0x12 0x02 0xBF 0x0E 0xFF 0xBF 0x04 0xFF 0x14 0x64 0x02 0xA0 0xB0 0x38 0xCC 0x98 0x8C 0xFE 0xFF 0x9C 0xAF 0xFF 0xFF 0x3C 0x2C 0x17 0xF3 0x01 0xE8 0x03 0x22 0xB4 0x0F 0x00 0x00 0x00 0x00 0x1B 0x88 0xA2 0xFC 0x6C 0x00""""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Common>delay,"{subsubtestname=""Delay-1000ms_2""}",,,,,,,,"delay 1000ms"
,"+{delay=""1000""}",,,,,,,,
,"+{unit=""ms""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-LDCM_Enable_CMD""}",,,,,,,,"enable LDCM"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace --pick ATC0 --4cc LDCM --txdata 0x40 0x00 0x00 0x00 0x00""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Common>delay,"{subsubtestname=""Delay-500ms""}",,,,,,,,"Delay 500ms"
,"+{delay=""500""}",,,,,,,,
,"+{unit=""ms""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-PP5V0_Enable_CMD""}",,,,,,,,"Pull high GPIO7 to enable PP5V0,rdar://112808243"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace -p ATC0 -c GPIO -t 0x80 0x00 0x00 0x00 0x01 0x85""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-Ace_leakage_CMD""}",ace_result,,,,,,,"Read ace 0x6a data"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Timeout=""10""}",,,,,,,,
,"+{Commands=""ace --pick ATC0 --4cc LDCM --txdata ""0x80 0x00 0x00 0x00 0x00"";ace -r 0x6a""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCVBUSVoltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report Vbus voltage"
,"+{pattern=""0000000%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*30/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPP5V0Voltage""}",,,,,,production_mode=="0",,"Pull high GPIO7 and put pdvbus off to get the ACE report PP_5V0 voltage"
,"+{pattern=""0000000%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*5/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPP5V0Voltage_Prodfuse""}",,,,,,production_mode=="1",,"Pull high GPIO7 and put pdvbus off to get the ACE report PP_5V0 voltage"
,"+{pattern=""0000000%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*5/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPP5V0EXTCurrent""}",,,,,,,,"Pull high GPIO7 to get the ACE report PP_5V0 current"
,"+{pattern=""0000010%:%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*1/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPPHVVoltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report PP_HV voltage"
,"+{pattern=""0000010%:%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*30/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPPHVCurrent""}",,,,,,,,"Pull high GPIO7 to get the ACE report PP_HV current"
,"+{pattern=""0000010%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*1/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPPCABLEVoltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report PP_CABLE voltage"
,"+{pattern=""0000010%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*5/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCCC1Voltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report CC1_VCONN voltage"
,"+{pattern=""0000020%:%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*5/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCPPCABLECurrent""}",,,,,,,,"Pull high GPIO7 to get the ACE report PP_CABLE current"
,"+{pattern=""0000020%:%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*1/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCCC2Voltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report CC2_VCONN voltage"
,"+{pattern=""0000020%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*5/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCVIN3V3Voltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report VIN_3V3 voltage"
,"+{pattern=""0000020%:%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*3/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCVOUTLVVoltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report VOUT_LV voltage"
,"+{pattern=""0000030%:%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*3/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/USBC>readACEVoltage,"{subsubtestname=""Read-ADCMCVDDIOVoltage""}",,,,,,,,"Pull high GPIO7 to get the ACE report VDDIO voltage"
,"+{pattern=""0000030%:%s*%w+%s*%w+%s*%w+%s*%w+%s*(%w+)%s*%w(%w)""}",,,,,,,,
,"+{scale=""12""}",,,,,,,,
,"+{formula=""1.5*2/2^12""}",,,,,,,,
,"+{Input=ace_result}",,,,,,,,
,"+{calmode=""*""}",,,,,,,,
,"+{InnerCall=""YES""}",,,,,,,,
,"+{record=""true""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-LDCM_Disable_CMD""}",,,,,,,,"disable LDCM"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace --pick ATC0 --4cc LDCM --txdata 0x00 0x00 0x00 0x00 0x00""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Common>delay,"{subsubtestname=""Delay-500ms_2""}",,,,,,,,delay 500ms
,"+{delay=""500""}",,,,,,,,
,"+{unit=""ms""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-PP5V0_Disable_CMD""}",,,,,,,,"Pull high GPIO7 to Pull low GPIO7 to disable PP5V0 to enter normal status,rdar://112808243"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace -p ATC0 -c GPIO -t 0x80 0x00 0x00 0x00 0x01 0x84""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Common>delay,"{subsubtestname=""Delay-1000ms_3""}",,,,,,,,delay 1000ms
,"+{delay=""1000""}",,,,,,,,
,"+{unit=""ms""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/DUTCmd>sendCmdAndParse,"{subsubtestname=""Send-ACE_Reset_CMD""}",,,,,,,,"reset ACE"
,"+{dutPluginName=""Kis_dut""}",,,,,,,,
,"+{channelPluginName=""Kis_channelPlugin""}",,,,,,,,
,"+{Commands=""ace --4cc ""GAID""""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Common>delay,"{subsubtestname=""Delay-500ms_3""}",,,,,,,,delay 500ms
,"+{delay=""500""}",,,,,,,,
,"+{unit=""ms""}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Tech/Fixture>sendFixtureCommand,"{subsubtestname=""Set-PDVBUS-5V""}",,,,,,,,"Set PDVBUS to 5v"
,"+{Commands=""relay_switch""}",,,,,,,,
,"+{args=""pdvbus;on""}",,,,,,,,
,"+{slotNum=slotNum}",,,,,,,,
,"+{record=""false""}",,,,,,,,
Returns,ace_result,,,,,,,,